# Exploit Development Tools - Always Available
# Modern exploit development and binary analysis
# Category: Security/Exploit Development

task install-checksec
  describe Install checksec binary protection checker
  shell echo "Installing checksec..."
  shell mkdir -p ~/.local/bin
  shell curl -s https://raw.githubusercontent.com/slimm609/checksec.sh/main/checksec -o ~/.local/bin/checksec
  shell chmod +x ~/.local/bin/checksec
  shell echo "✅ checksec installed successfully"
end

task install-pwntools
  describe Install pwntools exploit development framework
  shell echo "Installing pwntools..."
  shell pip3 install --user pwntools
  shell echo "✅ pwntools installed successfully"
end

task install-ropgadget
  describe Install ROPgadget ROP chain tool
  shell echo "Installing ROPgadget..."
  shell pip3 install --user ROPgadget
  shell echo "✅ ROPgadget installed successfully"
end

task install-ropper
  describe Install ropper as alternative ROP tool
  shell echo "Installing ropper..."
  shell pip3 install --user ropper
  shell echo "✅ ropper installed successfully"
end

task install-exploit-tools
  describe Install all exploit development tools (pwntools, checksec, ROPgadget, ropper)
  shell echo "╔════════════════════════════════════════════════════════════╗"
  shell echo "║         INSTALLING EXPLOIT DEVELOPMENT TOOLS              ║"
  shell echo "╚════════════════════════════════════════════════════════════╝"
  shell pf install-pwntools
  shell pf install-checksec
  shell pf install-ropgadget
  shell pf install-ropper
  shell echo "╔════════════════════════════════════════════════════════════╗"
  shell echo "║         ALL EXPLOIT TOOLS INSTALLED                       ║"
  shell echo "╚════════════════════════════════════════════════════════════╝"
end

task checksec
  describe Check binary security features
  shell checksec --file=${binary}
end

task pwn-cyclic
  describe Generate cyclic pattern for buffer overflow
  shell python3 -c "import pwn; print(pwn.cyclic(${length:-1000}))"
end

task pwn-cyclic-find
  describe Find offset in cyclic pattern
  shell python3 -c "import pwn; print('Offset:', pwn.cyclic_find('${pattern}'))"
end

task pwn-shellcode
  describe Generate shellcode for architecture
  shell python3 -c "import pwn; pwn.context.arch='${arch:-amd64}'; print(pwn.shellcraft.sh())"
end

task rop-find-gadgets
  describe Find all ROP gadgets in binary
  shell ROPgadget --binary ${binary} ${output:+> $output}
end

task exploit-help
  describe Show exploit development help
  shell echo "Exploit Development Tasks (Always Available):"
  shell echo "  pf install-exploit-tools          # Install all tools"
  shell echo "  pf checksec binary=<file>         # Check security features"
  shell echo "  pf pwn-cyclic length=1000         # Generate pattern"
  shell echo "  pf pwn-cyclic-find pattern=<hex>  # Find offset"
  shell echo "  pf rop-find-gadgets binary=<file> # Find ROP gadgets"
end
